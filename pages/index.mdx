# Запуск проекту

## Код сайту ІТВС

Код сайту ІТВС зберігаєтсь у відкритому репозиторії за посиланням: [itvs-v2](https://github.com/mykola-kolomoyets/itvs-v2)

## Пререквізити

- OS: Windows, Linux, macOS
- [NPM](https://www.npmjs.com/) >= 10.2.0
- [Node.js](https://nodejs.org/en/) >= 16.0.0 (бажано LTS)

>  За більш детальними вимогами можна відкрити файл у корні проекту `package.json` та переглянути вимоги до залежностей.

## Порядок розгортання проекту

### Клонування проекту

> **РЕМАРКА**: У випадку, якщо при розгортанні проекту достатньо плосилання на публічний [репозиторій](https://github.com/mykola-kolomoyets/itvs-v2), то цей крок можна пропустити.

Щоб склонувати проект у власну директорію, виконайте команду:

```bash copy
git clone https://github.com/mykola-kolomoyets/itvs-v2.git
```

### Встановлення залежностей

```bash copy
npm install
```

### Задання змінних оточення

> Шаблон змінних оточення розташований у корні проекту у файлі `.env.example`. Щоб задати змінні оточення, необхідно створити файл `.env` у корні проекту та скопіювати в нього вміст файлу `.env.example`. Після цього необхідно задати значення змінних оточення у файлі `.env`.

> **РЕМАРКА**: Ті змінні, які починаються з `NEXT_PUBLIC_` доступні тільки на клієнтській стороні. Інші змінні доступні лише на стороні сервера, для виконання tRPC-процедур та авторизації.

```bash copy
NODE_ENV=development
NEXT_PUBLIC_NODE_ENV=development
```
Відповідають за логування та вивід проміжних результатів у консоль. У випадку значення `production` логування та вивід проміжних результатів у консоль відключається.

---

```bash copy
DATABASE_URL=
```
Так як формат бази даних для цього проекту був заданий як `MySQL`, то для роботи з базою даних необхідно задати змінну `DATABASE_URL` у форматах: 

`mysql://user:password@host:port/database`. 

або, у випадку використання `PostgreSQL`:

`postgres://user:password@host:port/database`.

---

```bash copy
NEXTAUTH_URL=
NEXTAUTH_SECRET=
```
- `NEXTAUTH_URL` - це домен, за яким буде використовуватись для авторизації, на нього будуть іти перенаправлення. Рекомендовано, щоб ця адреса була вдентиною адресі сайту ІТВС після розгортання
- `NEXTAUTH_SECRET` - це секретний ключ, який буде використовуватись для шифрування сесійних куків. Його можна згенерувати за допомогою команди:

```bash copy
openssl rand -hex 32
```

---

```bash copy
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
```
- `GOOGLE_CLIENT_ID` - це ідентифікатор клієнта, який буде використовуватись для авторизації через Google
- `GOOGLE_CLIENT_SECRET` - це секретний ключ, який буде використовуватись для авторизації через Google

> **РЕМАРКА**: Щоб отримати `GOOGLE_CLIENT_ID` та `GOOGLE_CLIENT_SECRET` необхідно створити проект у [Google Cloud Platform](https://console.cloud.google.com/), а потім створити OAuth-клієнта у [Google API Console](https://console.developers.google.com/apis/credentials). 

> **Щоб авторизація працювала ТІЛЬКИ для користувачів, які мають пошту НУЛП, проект та OAuth-клієнта треба створювати саме з пошти НУЛП** Детальніше про Google-авторизацію через NextAuth можна прочитати [тут](https://next-auth.js.org/providers/google).

---

```bash copy
JWT_SECRET=
```
Згенерований секретний ключ для шифрування JWT-токенів. Його можна згенерувати за допомогою команди `openssl rand -hex 32`.

```bash copy
openssl rand -hex 32
```

### Запуск проекту

Для запуску проекту в режимі розробки виконайте команду:

```bash copy
npm run dev
```

Для запуску проекту в режимі продакшн виконайте команду, або задайте виконання цих команд у середовищі:

```bash copy
npm run build
npm run start
```

### База даних

> **РЕМАРКА**: Якщо після попередніх кроків не виникло проблем з іпідключенням до бази даних, то цей крок можна пропустити.

Для роботи з базою даних використовується ORM-бібліотека [Prisma](https://www.prisma.io/). У випадку, якщо бази даних ще не створено, то варто виконати наступну команду:

```bash copy
npx prisma migrate dev --name init
```

> **РЕМАРКА**: Якщо виникли проблеми з підключенням до бази даних, то можна ознайомитись з документацією Prisma [тут](https://www.prisma.io/docs/getting-started/setup-prisma/add-to-existing-project/relational-databases/connect-your-database-typescript-postgresql)








